<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"    
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:composition template="./../adminTemplate.xhtml">

        <ui:define name="content">
            <b:container fluid="true">
                <b:row>
                    <b:column col-lg="12">
                        <div>
                            <h3>Pedidos<small> Listado de Pedidos segun usuario.</small></h3>                            
                        </div>
                    </b:column>

                    <h:form id="formularioRegistro">  
                        <c:choose>
                            <c:when test="#{pedidoCT.vista == 0}">
                                <b:column col-lg="12" col-md="12" col-sm="12" col-xs="12">
                                    <p:messages id="messages" closable="true"/>
                                </b:column>

                                <b:column col-lg="8" col-md="8" col-sm="12" col-xs="12">
                                    <div class="box pad-10" >
                                        <div class="box-body">

                                        </div>
                                    </div>
                                </b:column>

                                <b:column col-lg="4" col-md="4" col-sm="12" col-xs="12">
                                    <div class="box pad-10" >
                                        <div class="box-body">
                                            <b:dateTimePicker style="width: 100%" show-time="false" mode="inline"/>
                                        </div>
                                    </div>
                                </b:column>


                                <b:column col-lg="12" col-md="12" col-sm="12" col-xs="12">
                                    <div align="right" class="breadcrumb">
                                        <p:inputText class="form-control" value="#{pedidoCT.buscar}" style="width: 50%" type="text" placeholder="Buscar...">
                                            <p:ajax event="keyup" listener="#{pedidoCT.buscarPedido()}" update="DTPedidos"/>
                                        </p:inputText>
                                    </div>
                                </b:column>

                                <b:column col-lg="12" col-md="12" col-sm="12" col-xs="12">                            
                                    <div>                                
                                        <div>
                                            <p:dataScroller scrollHeight="1000" id="DTPedidos" style="width: 100%" chunkSize="4" value="#{pedidoCT.pedidos}" var="pedido">
                                                <f:facet name="header">
                                                    Pedidos
                                                </f:facet>

                                                <f:facet name="loader">
                                                    <p:commandButton type="button" value="Mas" icon="ui-icon-circle-triangle-s"/>
                                                </f:facet>

                                                <b:column col-lg="6" col-md="6" col-xs="12" col-sm="12">    
                                                    <div class="table-responsive">

                                                        <div class="brdr bgc-fff pad-10 box-shad btm-mrg-20 property-listing-pv">
                                                            <div>
                                                                <h5>Cliente: <small> #{pedido.usuario.nombre} #{pedido.usuario.apellido} </small></h5>                            
                                                            </div>

                                                            <div class="media">
                                                                <div class="col-lg-4 col-md-4 col-sm-4">
                                                                    <a class="pull-left" href="#" target="_parent">
                                                                        <img alt="image" class="img-responsive " 
                                                                             src="http://images.prd.mris.com/image/V2/1/Yu59d899Ocpyr_RnF0-8qNJX1oYibjwp9TiLy-bZvU9vRJ2iC1zSQgFwW-fTCs6tVkKrj99s7FFm5Ygwl88xIA.jpg" />
                                                                    </a>                                                    
                                                                </div>

                                                                <div class="col-lg-8 col-md-8 col-sm-8">
                                                                    <div class="media-body fnt-smaller">
                                                                        <a href="#" target="_parent"></a>

                                                                        <h4 class="media-heading">
                                                                            <a href="#" target="_parent">$#{costoCT.consultarCostoPedido(pedido)} <small class="pull-right">#{pedido.direccionRecogida}</small></a></h4>

                                                                        <p class="hidden-xs">
                                                                            <strong>Observacines:</strong> 
                                                                            Descripcion de observaciones acerca del pedido especifico, tipo de tela, 
                                                                            daños de la prenda, manchas, etc.
                                                                            <h:commandButton  onclick="PrimeFaces.monitorDownload(start, stop);"  value="Ver Pedido" class="btn btn-primary btn-xs btn-block">
                                                                                <p:ajax event="click" listener="#{pedidoCT.verPedido(pedido)}" update=":formularioRegistro"/>
                                                                            </h:commandButton>

                                                                        </p>
                                                                        <span class="fnt-smaller fnt-lighter fnt-arial">
                                                                            <div class="col-xs-6">
                                                                                <strong>Recibido: </strong> #{pedido.fechaRecogida}                                                                
                                                                            </div>
                                                                            <div class="col-xs-6">
                                                                                <strong>Entrega: </strong> #{pedido.fechaEntrega}                                                                                                                            
                                                                            </div>
                                                                        </span>
                                                                    </div>                                                    
                                                                </div>
                                                            </div>
                                                        </div><!-- End Listing--> 
                                                    </div>
                                                </b:column>                                               
                                            </p:dataScroller>
                                        </div>
                                    </div>                            
                                </b:column>
                            </c:when>
                            <c:when test="#{pedidoCT.vista == 1}">
                                <b:column col-lg="12" col-md="12" col-sm="12" col-xs="12">
                                    <p:messages id="messages" closable="true"/>
                                </b:column>

                                <b:column col-lg="12" col-md="12" col-sm="12" col-xs="12">
                                    <div class="box box-success">
                                        <div class="box-header with-border">
                                            <i class="fa fa-2x fa-globe"/>
                                            <h4 class="box-title">Datos del Barrio</h4>
                                        </div> 
                                        <div class="box-body">
                                            <div class="table-responsive">
                                                <!-- VISTA DE PEDIDO POR PERSONA-->
                                                <div class="brdr bgc-fff pad-10 box-shad btm-mrg-20 property-listing-pv">

                                                    <div class="media">
                                                        <div class="col-lg-4 col-md-4 col-sm-4">
                                                            <a class="pull-left" href="#" target="_parent">
                                                                <p:graphicImage alt="image" value="#{pedidoCT.pedido.usuario.rutaImagen}" height="100%" width="200px" class="img-responsive"/>
                                                            </a>                                                    
                                                        </div>

                                                        <div class="col-lg-8 col-md-8 col-sm-8">
                                                            <div class="media-body fnt-smaller">
                                                                <a href="#" target="_parent"></a>
                                                                <div>
                                                                    <h3>#{pedidoCT.pedido.usuario.nombre} #{pedidoCT.pedido.usuario.apellido} <small> N° referencia: #{pedidoCT.pedido.idPedido}</small></h3>                            
                                                                </div>

                                                                <h4 class="media-heading">
                                                                    <small class="pull-left"><strong>Dirección Recogida: </strong>#{pedidoCT.pedido.direccionRecogida}
                                                                        <strong style="margin-left: 20px">Cel: </strong>#{pedidoCT.pedido.usuario.movil}
                                                                    </small>
                                                                </h4>

                                                                <br/>

                                                                <h4 class="media-heading">
                                                                    <small>
                                                                        <a href="#" target="_parent">$#{costoCT.consultarCostoPedido(pedidoCT.pedido)}</a>
                                                                    </small>
                                                                </h4>

                                                                <div class="mrg-desc-prod">
                                                                    <p class="hidden-xs">
                                                                        <strong>Observacines:</strong> 
                                                                        Descripcion de observaciones acerca del pedido especifico, tipo de tela, 
                                                                        daños de la prenda, manchas, etc.
                                                                    </p>
                                                                </div>
                                                            </div>                                                    
                                                        </div>
                                                    </div>
                                                </div><!-- End Listing-->

                                                <div>
                                                    <h4 class="mrg-titles">Prendas del Pedido<small> N° #{pedidoCT.pedido.idPedido}</small></h4>                            
                                                </div>

                                                <c:forEach items="#{descripcionPedidoCT.consultarDescripcionesSinFotosSegunPedido(pedidoCT.pedido)}" var="producto" begin="0" end="#{descripcionPedidoCT.consultarDescripcionesSinFotosSegunPedido(pedidoCT.pedido).size()}">
                                                    <div class="col-md-6 col-lg-6 col-sm-12 col-xs-12">
                                                        <!-- LISTA DE PRODUCTOS POR PEDIDOS-->
                                                        <div class="brdr bgc-fff pad-10 box-shad btm-mrg-20 property-listing-pv">
                                                            <div class="media">
                                                                <div class="col-lg-4 col-md-4 col-sm-4">
                                                                    <a class="pull-left" href="#" target="_parent">
                                                                        <p:graphicImage value="#{producto.subProducto.rutaImagen}" width="150px" height="150px"/>
                                                                    </a>                                                    
                                                                </div>

                                                                <div class="col-lg-8 col-md-8 col-sm-8">
                                                                    <div class="media-body fnt-smaller">
                                                                        <a href="#" target="_parent"></a>
                                                                        <div>
                                                                            <h3>#{producto.subProducto.nombre} 
                                                                                <small> 
                                                                                    <a href="#" target="_parent">$#{costoCT.consultarCostoSubProducto(producto.subProducto)}</a>
                                                                                </small>
                                                                            </h3>                            
                                                                        </div>
                                                                        <p class="hidden-xs">#{producto.subProducto.descripcion}</p><span class="fnt-smaller fnt-lighter fnt-arial"></span>
                                                                        <div align="center">
                                                                            <p:commandButton style="width: 60%" class="btn btn-primary btn-xs btn-block" value="Ver Prenda"/>
                                                                        </div>
                                                                    </div>                                                    
                                                                </div>
                                                            </div>
                                                        </div><!-- End Listing-->
                                                    </div>  
                                                </c:forEach>
                                            </div>
                                        </div>
                                        <div class="box box-footer" align="left">
                                            <p:commandButton icon="fa fa-arrow-left" onclick="PrimeFaces.monitorDownload(start, stop);" 
                                                             action="#{pedidoCT.volverPedidos()}" update=":formularioRegistro" value="Regresar" style="width: 20%" class="btn btn-info"/>
                                        </div>
                                    </div>
                                </b:column>    
                            </c:when>
                        </c:choose>
                        <script type="text/javascript">
                            function start() {
                                PF('statusDialog').show();
                            }
                            function stop() {
                                PF('statusDialog').hide();
                            }
                        </script>
                        <p:dialog id="dialog" modal="true" widgetVar="statusDialog" header="Cargando..." draggable="false" closable="false" resizable="false">
                            <p:graphicImage width="100%" value="/resources/images/demo/ajaxloadingbar.gif" />
                        </p:dialog>
                    </h:form>
                </b:row>
            </b:container>         
        </ui:define>
    </ui:composition>
</html>
