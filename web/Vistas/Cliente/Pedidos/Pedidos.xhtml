<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"    
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <h:body>
        <ui:composition template="./../clienteTemplate.xhtml">
            <ui:define name="content">

                <!--DEFINICION DEL BANNER-->
                <!-- banner start -->
                <section class="heigth-section">
                    <!--CON EL BANNER, SE VA A REUTILIZAR CODIGO CON JLTS
                    COLOCANDO LOS NOMBRES SEGUN LA EDSCRIPCION Y UN ID-->
                    <div class="container-fluid heigth-section" >
                        <div class="row heigth-section" >
                            <div class="col-med-12">
                                <div class="banner-section">                       
                                    <!-- particles.js container --> 
                                    <div id="particles-js"></div>             
                                    <!-- particles.js lib - https://github.com/VincentGarreau/particles.js --> 
                                    <!--  <script src="http://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>  -->
                                    <h:outputScript name="./../../js/particles.js" />
                                </div>
                                <div class="col-sm-6 col-xs-12 banner-first">   
                                    <div class="dec-title">
                                        <i class="fa fa-5x fa-check-square-o cent" aria-hidden="true"></i>
                                        <h2 class="title-banner">Define las Prendas</h2>
                                    </div>
                                </div>          
                                <div class="col-sm-4 banner-sec">   
                                    <h3 class="ti-bann-desc">Escoje las prendas que desees</h3>
                                    <p class="text-justify">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aspernatur natus eaque illo alias omnis, hic velit.</p>
                                </div> 
                                <div class="col-sm-2">   
                                </div> 
                            </div>
                        </div>
                    </div>                  
                </section>
                <!-- BANNER END -->             


                <!-- CONTENIDO -->
                <h:form id="formularioContenido" target="#{pedidoCT.pedido}">
                    <c:choose>
                        <c:when test="${pedidoCT.vista == 0}">
                            <div>
                                <section class="alt-catego">
                                    <div class="container-fluid alt-catego" >
                                        <div class="row alt-catego" >
                                            <div class="col-sm-12 enlinea ">                     
                                                <ul class="nav nav-pills">
                                                    <c:forEach var="producto" begin="0" items="#{productoCT.productos}" end="#{productoCT.productos.size()}">
                                                        <li>
                                                            <div class="box box-widget">
                                                                <div align="center" class="box-body">
                                                                    <p:graphicImage value="#{producto.rutaImagen}"/>
                                                                </div>
                                                                <div align="center" class="box-footer">
                                                                    <p:commandLink value="#{producto.nombre}">
                                                                        <f:setPropertyActionListener value="#{producto}" target="#{productoCT.producto}"/>
                                                                        <p:ajax event="click" listener="#{subProductoCT.consultarProductosSegunProducto(producto.idProducto)}" update="@form"/>
                                                                    </p:commandLink>
                                                                </div>
                                                            </div>                                
                                                        </li>
                                                    </c:forEach>
                                                </ul>                                                
                                            </div>
                                        </div>             
                                    </div>
                                </section>                                
                                <!--CATEGORIAS PRENDAS-->

                                <!--PRENDAS-->
                                <section>
                                    <div class="container pad-container">
                                        <div class="row">                                            
                                            <c:forEach items="#{subProductoCT.subProductosConCosto}" var="subproducto" begin="0" end="#{subProductoCT.subProductosConCosto.size()}">
                                                <div class="col-md-6 col-sm-6 col-xs-10 esp-prenda">
                                                    <div class="row border-r">
                                                        <div class="col-xs-4" >
                                                            <p:graphicImage value="#{subproducto.rutaImagen}" width="180px" height="220px"/>
                                                        </div>
                                                        <div style="padding-left: 75px" class="col-xs-8 pad-content">
                                                            <h3 class="title-prenda">#{subproducto.nombre}</h3>
                                                            <p class="txt-justify">#{subproducto.descripcion}</p>
                                                            <p class="txt-justify">$#{subproducto.costo.valor}</p>   

                                                            <!-- INICION DE CONTADOR -->
                                                            <div align="left">
                                                                <h:panelGrid  width="80%" columns="2">                                                 
                                                                    <h:commandButton id="btnAgregar" value="Agregar" class="btn btn-info">
                                                                        <p:ajax event="click" update="numPrendas" listener="#{pedidoCT.agregarproductos(subproducto)}"/>
                                                                    </h:commandButton>                                                
                                                                </h:panelGrid><br/>
                                                            </div><!-- INICION DE CONTADOR -->
                                                        </div>                                    
                                                    </div>
                                                </div>
                                            </c:forEach>                        
                                        </div>
                                    </div>
                                </section>
                                <!--PRENDAS-->
                            </div>
                        </c:when>
                        <c:when test="${pedidoCT.vista == 1}">
                            <section>  
                                <div class="container ">
                                    <div class="row"><!-- ROW PRINCIPAL -->
                                        <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12
                                             col-lg-offset-1 col-md-offset-1 col-sm-offset-1  pos-form ">
                                            <div class="row ">                                                
                                                <div class="col-xs-12 col-md-6"><!-- inicion / fin columnas -->
                                                    <div class="pedido">                               

                                                        <div class="form-group">
                                                            <label class="label-lv" for="">Calendario para Pedido</label>
                                                            <b:dateTimePicker value="#{pedidoCT.pedido.fechaRecogida}" show-time="false"/>
                                                            <span class="help-block"><em>* Define la fecha de recogida de la prendas. </em></span>								
                                                        </div>   
                                                        <div class="form-group">
                                                            <label class="label-lv" for="">Zona Horaria</label>
                                                            <h:selectOneMenu value="#{pedidoCT.pedido.horaInicio.horario}" class="form-control input-lg input-lg-lv">
                                                                <f:selectItem itemLabel="Horario" noSelectionOption="true"/>
                                                                <f:selectItems value="#{horarioCT.horarios}" var="horario" itemLabel="#{horario.horario}" itemValue="#{horario.horario}"/>
                                                            </h:selectOneMenu>
                                                            <span class="help-block"><em>* Define horario de recogida de las prendas.</em></span>							
                                                        </div>

                                                        <div class="form-group">
                                                            <label class="label-lv" for="">Barrio</label>
                                                            <h:selectOneMenu value="#{pedidoCT.pedido.barrioRecogida.nombre}" class="form-control input-lg input-lg-lv">
                                                                <f:selectItem itemLabel="Barrios" noSelectionOption="true"/>
                                                                <f:selectItems value="#{barrioCT.barrios}" var="barrio" itemLabel="#{barrio.nombre}" itemValue="#{barrio.nombre}"/>
                                                            </h:selectOneMenu>
                                                            <span class="help-block"><em>* Define barrio de residencia para la recogida de las prendas.</em></span>                                        
                                                        </div>

                                                        <div class="form-group">
                                                            <label class="label-lv" for="">Dirección de residencia </label>
                                                            <p:inputText type="text" value="#{pedidoCT.pedido.direccionRecogida}" class="form-control input-lg input-lg-lv" placeholder="Direccion de pedido" />
                                                            <span class="help-block"><em>* Direccion de la residencia donde seran recogidas las prendas.</em></span>	
                                                        </div>

                                                        <div class="form-grup">
                                                            <label for="" class="label-lv">Quien entrega?</label>
                                                            <p:inputText type="text" class="form-control input-lg input-lg-lv" value="#{pedidoCT.pedido.quienEntrega}" placeholder="Nombre de la persona que entrega las prendas..." />
                                                            <span class="help-block"><em>* Nombre de la persona que entregara las prendas.</em></span>	
                                                        </div>                              
                                                    </div>
                                                </div><!-- fin columnas -->

                                                <div class="col-xs-12 col-md-6"><!-- inicion / fin columnas -->
                                                    <div class="entrega">                               

                                                        <div class="form-group">
                                                            <label class="label-lv" for="">Calendario para Entrega</label>
                                                            <b:dateTimePicker value="#{pedidoCT.pedido.fechaEntrega}" show-time="false"/>
                                                            <span class="help-block"><em>* Define la fecha de entrega de la prendas. </em></span>								
                                                        </div>
                                                        <div class="form-group">
                                                            <label class="label-lv" for="">Zona Horaria</label>
                                                            <h:selectOneMenu value="#{pedidoCT.pedido.horaFinal.horario}" class="form-control input-lg input-lg-lv">
                                                                <f:selectItem itemLabel="Horario" noSelectionOption="true"/>
                                                                <f:selectItems value="#{horarioCT.horarios}" var="horario" itemLabel="#{horario.horario}" itemValue="#{horario.horario}"/>
                                                            </h:selectOneMenu>
                                                            <span class="help-block"><em>* Define horario de entrega de las prendas.</em></span>							
                                                        </div>                                   

                                                        <div class="form-group">
                                                            <label class="label-lv" for="">Barrio</label>
                                                            <h:selectOneMenu value="#{pedidoCT.pedido.barrioEntrega.nombre}" class="form-control input-lg input-lg-lv">
                                                                <f:selectItem itemLabel="Barrios" noSelectionOption="true"/>
                                                                <f:selectItems value="#{barrioCT.barrios}" var="barrio" itemLabel="#{barrio.nombre}" itemValue="#{barrio.nombre}"/>
                                                            </h:selectOneMenu> 
                                                            <span class="help-block"><em>* Define barrio de residencia para la entrega de las prendas.</em></span>                                       
                                                        </div>

                                                        <div class="form-group">
                                                            <label class="label-lv" for="">Dirección de entrega</label>
                                                            <p:inputText type="text" value="#{pedidoCT.pedido.direccionEntrega}" class="form-control input-lg input-lg-lv" placeholder="Direccion de entrega de las prendas" />
                                                            <span class="help-block"><em>* Direccion de la residencia donde seran entregadas las prendas.</em></span>
                                                        </div>

                                                        <div class="form-grup">
                                                            <label for="" class="label-lv">Quien recibe?</label>
                                                            <p:inputText type="text" value="#{pedidoCT.pedido.quienRecibe}" class="form-control input-lg input-lg-lv" placeholder="Nombre de la persona que recibe las prendas..."/>
                                                            <span class="help-block"><em>* Nombre de la persona que recibira las prendas.</em></span>	
                                                        </div>                               
                                                    </div>
                                                </div><!-- fin columnas -->                                                
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-md-12" style="padding-top: 26px">
                                                    <div class="recomendaciones">
                                                        <div class="form-grup">
                                                            <label for="" class="label-lv">Recomendaciones y Comentarios</label>
                                                            <h:inputTextarea rows="3" class="form-control input-lg-lv"/>                                    	
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div><!-- ROW PRINCIPAL -->
                                </div>        
                            </section>
                        </c:when>
                        <c:when test="${pedidoCT.vista == 2}">
                            <section>

                            </section>
                        </c:when>                       
                    </c:choose>
                    <section>
                        <div class="container">
                            <div class="row brd-btn-update">
                                <div class="col-md-12 col-xs-12 ">
                                    <div class="col-md-6  col-xs-6  mrg-table">
                                        <div align="left">
                                            <p:commandButton class="btn btn-lg btn-primary" rendered="#{pedidoCT.botonatras}" update=":formularioContenido"  action="#{pedidoCT.atras()}" value="Atras" />
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-xs-6 mrg-table" >
                                        <div align="right">
                                            <p:commandButton class="btn btn-lg btn-primary" rendered="#{pedidoCT.botonsiguiente}" update=":formularioContenido" action="#{pedidoCT.siguiente()}" value="Siguiente" />                                       					
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </h:form>

                <!-- CONTENIDO END-->

                <p:commandButton id="numPrendas" update=":modal" class="btn-num-prendas" icon="fa fa-pencil-square-o fa-2x pos-info-btn ico-forma" value="#{pedidoCT.cantidadProductos}">
                    <p:ajax event="click" listener="#{pedidoCT.organizarSubProductosPedido()}"/>
                    <f:passThroughAttribute name="data-toggle" value="modal"/>
                    <f:passThroughAttribute name="data-target" value="#myModal"/>
                </p:commandButton>

                <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title" id="myModalLabel">Prendas</h4>
                            </div>
                            <div class="modal-body">
                                <h:form id="modal"> 
                                    <c:forEach begin="0" end="#{pedidoCT.subproductosOrdenados.size()}" items="#{pedidoCT.subproductosvista}" var="subProducto"> 
                                        <div class="esp-prenda">
                                            <div class="row border-r">
                                                <table>
                                                    <tr>
                                                        <td>
                                                            <div style="width: 30% " >
                                                                <p:graphicImage width="180px" height="220px" value="#{subProducto.rutaImagen}"/>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <div style="padding-left: 50px"  class="col-xs-8 pad-content">
                                                                <h3 class="title-prenda">#{subProducto.nombre}</h3>
                                                                <p class="txt-justify">#{subProducto.descripcion}</p>
                                                                <h4 style="font-size: xx-large">#{pedidoCT.calcularCantidadPrendas(subProducto)}</h4>
                                                                <!-- INICION DE CONTADOR -->
                                                                <div align="left">
                                                                    <h:panelGrid  width="80%" columns="2">                                                 
                                                                        <p:commandButton id="btnAgregar" action="#{pedidoCT.eliminarproducto(subProducto)}" update="numPrendas :modal" value="Eliminar" class="btn btn-danger">

                                                                        </p:commandButton>
                                                                    </h:panelGrid><br/>
                                                                </div><!-- INICION DE CONTADOR -->
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>                                            
                                        <hr/>
                                    </c:forEach>                                  
                                </h:form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                            </div>
                        </div>
                    </div>
                </div>                
            </ui:define>
        </ui:composition>
    </h:body>

    <h:outputScript name="./js/moment-with-locales.min.js"  />
    <h:outputScript name="./js/bootstrap-datetimepicker.min.js"/>
</html>
